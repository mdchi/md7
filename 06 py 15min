#curso de beautifulsoup https://www.youtube.com/watch?v=yKi9-BfbfzQ
#curso de selenium https://www.youtube.com/watch?v=v_LUqyKFN_s 
#llamada a chromedrivemanager https://www.youtube.com/watch?v=V7PN7-RRueg
import os
import time
from selenium import webdriver  #pip install selenium
from selenium.webdriver.chrome.service import Service
from selenium.webdriver.chrome.options import Options
from webdriver_manager.chrome import ChromeDriverManager  #pip install webdriver-manager
import pyautogui
import requests

def pausa (seg):
    for i in range(seg,0,-1):
        print(f"{i}  ", end="\r")
        time.sleep(1)
    
#funcion on/off wifi  
#ver name: netsh interface show interface
def wifi(modo): 
    if modo=='on':
        os.system('netsh wlan connect md1')
        pausa(20)
    elif modo=='off':
        time.sleep(10)
        os.system('netsh wlan disconnect')

def wifi2():
    pyautogui.click(1820,1055)
    time.sleep(3)
    pyautogui.click(1530,990)
    time.sleep(3)
    pyautogui.click(1530,990)
    time.sleep(30)
    pyautogui.click(900,530)

while True:
    wifi('on')

    #abre chromium
    options=Options()
    options.add_experimental_option("detach",True)
    driver = webdriver.Chrome(service=Service(ChromeDriverManager().install()), options=options)
    driver.get('https://mdchi.github.io/md7-noticias/')
    time.sleep(3)
    pyautogui.press('f11')
    
    wifi('off')

    pausa(900)  # pausa 1h=3600seg 10hs=36000seg

    pyautogui.keyDown('alt') #cerrar ventana
    pyautogui.keyDown('f4')
    pyautogui.keyUp('f4')
    pyautogui.keyUp('alt')
    time.sleep(3)
